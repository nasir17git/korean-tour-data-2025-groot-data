# 관광 데이터 크롤러 (Tourism Data Crawler)

한국관광공사 공공데이터 API를 활용하여 다양한 관광 정보를 수집하는 Python 크롤러 프로그램입니다.

## 🚀 빠른 시작

### 1. 환경 설정

#### 필요한 패키지 설치
```bash
pip install requests python-dotenv
```

#### 환경 변수 설정
```bash
# .env.example을 복사하여 .env 파일 생성
cp .env.example .env

# .env 파일을 편집하여 실제 값 입력
nano .env
```

**.env 파일 설정 방법:**

1. **공공데이터포털 API 키 발급**
   - [공공데이터포털](https://www.data.go.kr) 회원가입 및 로그인
   - 다음 API들 신청 및 승인 대기:
     - `한국관광공사_생태관광 서비스`
     - `한국관광공사_무장애 관광 서비스` 
     - `한국관광공사_중심 관광지 서비스`
   - 발급받은 서비스 키를 `DATA_KEY_ENCODING`(인코딩), `DATA_KEY_DECODING`(디코딩) 에 입력

2. **Supabase 설정 (선택사항)**
   - [Supabase](https://supabase.com) 프로젝트 생성
   - 프로젝트 URL과 anon key를 `SUPABASE_BASE_URL`, `SUPABASE_API_KEY`에 입력
   - DB 저장 기능을 사용하지 않으면 설정하지 않아도 됨

### 2. 사용 방법

#### CLI 모드 (권장)
```bash
# 사용법: python3 main.py <API번호> <엔드포인트번호> <로컬저장T/F> <DB저장T/F>

# 예시 1: 생태 관광 정보 API의 지역코드 조회, 로컬 저장만
python3 main.py 1 1 T F

# 예시 2: 무장애 여행 정보 API의 지역기반 정보 조회, 로컬+DB 저장
python3 main.py 2 4 T T

# 예시 3: 기초지자체 중심 관광지 정보 API 조회, DB 저장만
python3 main.py 3 1 F T
```

#### 대화형 모드
```bash
python3 main.py
# 메뉴를 따라 선택하여 실행
# 로컬 저장 기본값: T (엔터만 눌러도 됨)
# DB 저장 기본값: F (엔터만 눌러도 됨)
```

### 3. API 및 엔드포인트 목록

#### API 1: 생태 관광 정보 API
- `1`: 지역코드조회
- `2`: 지역기반 생태관광정보 조회
- `3`: 생태관광정보 동기화 관광정보 조회

#### API 2: 무장애 여행 정보 API  
- `1`: 지역코드조회
- `2`: 분류체계 코드조회
- `3`: 법정동코드조회
- `4`: 지역기반 관광정보조회
- `5`: 무장애 여행정보 동기화 목록 조회

#### API 3: 기초지자체 중심 관광지 정보 API
- `1`: 지역기반 중심 관광지 정보 목록 조회 (경상북도 전체)

## ✨ 주요 기능

### 🔄 자동 페이징 처리
- **전체 데이터 수집**: API가 제공하는 모든 데이터를 자동으로 수집
- **진행 상황 표시**: 각 페이지별 수집 현황을 실시간으로 출력
- **스마트 종료**: totalCount 도달 시 자동 종료
- **안전 장치**: 최대 50페이지 제한으로 무한루프 방지
- **API 보호**: 0.1초 간격으로 요청하여 서버 부하 최소화

### 💾 유연한 저장 옵션
- **로컬 저장**: JSON 파일로 data/ 디렉토리에 저장
- **DB 저장**: Supabase 데이터베이스에 구조화된 형태로 저장
- **선택적 저장**: 로컬만, DB만, 또는 둘 다 저장 가능
- **타임스탬프**: 파일명에 자동으로 날짜/시간 추가

### 🏗️ 모듈화된 구조
- **API별 분리**: 각 API를 독립적인 모듈로 관리
- **공통 설정**: 환경변수와 공통 파라미터 중앙 관리
- **확장 가능**: 새로운 API 추가 시 쉽게 확장 가능

## 📊 데이터 수집 예시

### 소규모 데이터 (24개)
```bash
python3 main.py 1 1 T F
# [페이지 1] 24개 수집 (총 24개)
# [완료] 전체 24개 데이터 수집 완료
```

### 대규모 데이터 (625개)
```bash
python3 main.py 2 4 T F
# [페이지 1] 100개 수집 (총 100개)
# [페이지 2] 100개 수집 (총 200개)
# ...
# [페이지 7] 25개 수집 (총 625개)
# [완료] 전체 625개 데이터 수집 완료
```

## 🔧 환경 변수 설정 가이드

### 공공데이터포털 API 키 발급 과정
1. [공공데이터포털](https://www.data.go.kr) 접속
2. 회원가입 및 로그인
3. 다음 API 검색 및 신청:
   - "한국관광공사_생태관광 서비스"
   - "한국관광공사_무장애 관광 서비스"
   - "한국관광공사_중심 관광지 서비스"
4. 승인 대기 (보통 1-2일 소요)
5. 승인 후 서비스 키 확인
6. `.env` 파일에 키 입력

### Supabase 설정 과정 (선택사항)
1. [Supabase](https://supabase.com) 접속
2. 새 프로젝트 생성
3. Settings > API에서 URL과 anon key 확인
4. `.env` 파일에 정보 입력
5. 필요시 `tourism_data` 테이블 생성

## 🚨 주의사항

- **보안**: `.env` 파일은 절대 Git에 커밋하지 마세요
- **API 제한**: 공공데이터 API 호출 제한 정책을 준수하세요
- **네트워크**: 대용량 데이터 수집 시 안정적인 네트워크 환경 필요
- **저장공간**: data/ 디렉토리에 충분한 저장공간 확보

## 🐛 문제 해결

### API 호출 실패
- 서비스 키가 올바른지 확인
- API 승인 상태 확인
- 네트워크 연결 상태 확인

### DB 저장 실패
- Supabase 설정 정보 확인
- 테이블 존재 여부 확인
- API 키 권한 확인

### 파일 저장 실패
- data/ 디렉토리 권한 확인
- 디스크 용량 확인
